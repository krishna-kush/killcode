# ============================================
# KILLCODE - Environment Configuration
# ============================================
# Copy this to .env for development or .env.production for production

# ----------------
# Port Mappings
# ----------------
UI_PORT=5173
# When change this must change NEXT_PUBLIC_API_URL below too in development and in production must change the deployment config, typically the caddyfile of routing.
# Must also change killer's .env to match the new port for testing.
SERVER_PORT_EXTERNAL=8080
MONGODB_PORT=27018
# When change this must change WEAVER_EXTERNAL_URL below too
WEAVER_PORT_EXTERNAL=8081
REDIS_PORT=6379

# ----------------
# Database - MongoDB
# ----------------
MONGODB_URI=mongodb://mongodb:27017?replicaSet=rs0&directConnection=true
DATABASE_NAME=killcode

# For production with auth (uncomment and set passwords):
# MONGO_ROOT_USER=admin
# MONGO_ROOT_PASSWORD=change_this_secure_password
# MONGODB_URI=mongodb://${MONGO_ROOT_USER}:${MONGO_ROOT_PASSWORD}@mongodb:27017?replicaSet=rs0&directConnection=true

# ----------------
# Redis
# ----------------
REDIS_URL=redis://redis:6379

# For production with auth (uncomment and set password):
# REDIS_PASSWORD=change_this_secure_password
# REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# ----------------
# Server Configuration - Is Essential
# ----------------
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
# SERVER_URL is used in creating license
SERVER_URL=http://localhost:8080
WEAVER_URL=http://weaver:8080
WEAVER_EXTERNAL_URL=http://localhost:8081

# CORS Configuration
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# Storage Quota (Bytes) // 5GB
FREE_STORAGE_QUOTA=5368709120

# License Serving Policy
# If true: Serve license even if quota exceeded (don't cache it)
# If false: Reject download if quota exceeded (must have space to cache)
ALLOW_LICENSE_SERVE_VIA_RAM=false

# JWT Authentication (Generate with: openssl rand -base64 32)
JWT_SECRET=CHANGE_THIS_TO_SECURE_RANDOM_STRING_IN_PRODUCTION
JWT_EXPIRATION=86400

# Logging
RUST_LOG=info

# GeoIP Database
GEOIP_DB_PATH=/server/geoip/data/GeoLite2-Country.mmdb

# ----------------
# Weaver Configuration
# ----------------
WEAVER_HOST=0.0.0.0
WEAVER_PORT=8080
WEAVER_TEMP_DIR=/tmp/weaver
WEAVER_ENABLE_CROSS_HOST_TESTING=true
WEAVER_MAX_SIZE=524288000
WEAVER_EXPIRATION_HOURS=24
WEAVER_CLEANUP_INTERVAL=3600
WEAVER_BINARY_TTL=86400
MAIN_SERVER_URL=http://server:8080

# ----------------
# Mailer Service Configuration
# ----------------
MAILER_URL=http://mailer:8000

# SMTP Configuration
SMTP_HOST=mail.killcode.app
SMTP_PORT=587
SMTP_USER=noreply@killcode.app
SMTP_PASS=CHANGE_THIS_TO_SMTP_PASSWORD
SMTP_SECURE=true
SMTP_FROM=KillCode <noreply@killcode.app>
# Set to true if mail server has self-signed cert or hostname mismatch
SMTP_ACCEPT_INVALID_CERTS=false
SMTP_IMPLICIT_TLS=true

# ----------------
# UI Configuration
# ----------------
NEXT_PUBLIC_API_URL=http://localhost:8080
NEXT_TELEMETRY_DISABLED=1

# ----------------
# Google OAuth Configuration
# ----------------
# Get these from https://console.cloud.google.com/apis/credentials
# Create OAuth 2.0 credentials and add your origin URI: http://localhost:5173 and redirect URI: http://localhost:5173/auth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=